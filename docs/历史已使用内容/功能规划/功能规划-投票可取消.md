# 功能规划-投票可取消

## 现状
- 前端仅支持点赞/点踩一次，重复点击同方向不生效。
- 后端投票逻辑在同方向重复投票时返回 unchanged，不会撤销投票。

## 目标
- 支持再次点击取消投票（赞/踩都可撤销）。
- 前端展示与后端状态一致，分数与用户投票状态同步。

## 实施拆分

| 步骤 | 内容 | 状态 |
| --- | --- | --- |
| 1 | 后端投票逻辑支持重复投票撤销（删除投票记录并回滚分数） | ✅ 已完成 |
| 2 | 前端根据 API action 更新 userVote，支持赞/踩撤销 | ✅ 已完成 |
| 3 | 文档与计划状态更新，补充实施记录 | ✅ 已完成 |

## 涉及文件
- `packages/api/src/services/VoteService.js`
- `packages/frontend/src/app/question/[id]/page.tsx`
- `计划与进度.md`
- `docs/历史已使用内容/实施记录/2026-02-05-投票可取消.md`

## 完成标准
- 重复点击已投票方向可撤销。
- 分数与投票状态在前端即时同步。
- SOP 文档与记录完善。
