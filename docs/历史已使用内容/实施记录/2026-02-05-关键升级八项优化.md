# 2026-02-05 关键升级八项优化

## 目标
- 完成投票规则、列表联动、登录体验、搜索、排序、内容质量、SEO 分享、可观测性八项升级。

## 已实施清单
- 话题内单次投票（赞/踩互斥），清理同话题其他投票。
- 详情页投票与回答数变化联动到列表。
- Header 登录状态展示与退出入口。
- 搜索功能（API + 前端输入）。
- Hot/Top 排序公式区分并优化。
- 内容质量防护（最小字数限制）。
- 问题页动态 Metadata 支持分享展示。
- 请求日志与 Request ID 增强可观测性。

## 文件变更表
| 文件 | 说明 |
| --- | --- |
| `packages/api/src/services/VoteService.js` | 话题内单次投票规则与一致性修复 |
| `packages/api/src/services/QuestionService.js` | 搜索与排序公式优化 |
| `packages/api/src/services/AnswerService.js` | 内容最小字数限制 |
| `packages/api/src/routes/questions.js` | 支持 q 搜索参数 |
| `packages/api/src/app.js` | 请求日志中间件接入 |
| `packages/api/src/middleware/requestLogger.js` | Request ID + 访问日志 |
| `packages/frontend/src/app/page.tsx` | 搜索输入 + 投票/回答数联动 |
| `packages/frontend/src/app/question/[id]/page.tsx` | 投票/回答数联动事件 |
| `packages/frontend/src/app/question/[id]/layout.tsx` | 动态 Metadata |
| `packages/frontend/src/lib/api.ts` | 支持 q 搜索参数 |
| `packages/frontend/src/locales/zh.json` | 搜索文案 |
| `packages/frontend/src/locales/en.json` | 搜索文案 |
| `PROJECT_STRUCTURE.md` | 搜索参数说明 |
| `计划与进度.md` | 状态更新 |
